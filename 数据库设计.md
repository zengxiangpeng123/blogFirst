# 静隅思录 - 数据库设计

## 技术栈
- MySQL 8.0 + MyBatis-Plus + Spring Boot

---

## 表结构设计（共5张表）

### 1. 用户表 (user)

| 字段名 | 类型 | 约束 | 说明 |
|--------|------|------|------|
| id | BIGINT | PK, AUTO_INCREMENT | 用户ID |
| username | VARCHAR(50) | UNIQUE, NOT NULL | 用户名 |
| password | VARCHAR(255) | NOT NULL | 密码 |
| nickname | VARCHAR(50) | NOT NULL | 昵称 |
| email | VARCHAR(100) | | 邮箱 |
| avatar | VARCHAR(255) | | 头像URL |
| bio | VARCHAR(500) | | 个人简介 |
| created_at | DATETIME | DEFAULT CURRENT_TIMESTAMP | 创建时间 |
| updated_at | DATETIME | ON UPDATE CURRENT_TIMESTAMP | 更新时间 |

```sql
CREATE TABLE `user` (
  `id` BIGINT NOT NULL AUTO_INCREMENT COMMENT '用户ID',
  `username` VARCHAR(50) NOT NULL COMMENT '用户名',
  `password` VARCHAR(255) NOT NULL COMMENT '密码',
  `nickname` VARCHAR(50) NOT NULL COMMENT '昵称',
  `email` VARCHAR(100) COMMENT '邮箱',
  `avatar` VARCHAR(255) COMMENT '头像URL',
  `bio` VARCHAR(500) COMMENT '个人简介',
  `created_at` DATETIME DEFAULT CURRENT_TIMESTAMP,
  `updated_at` DATETIME DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,
  PRIMARY KEY (`id`),
  UNIQUE KEY `uk_username` (`username`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COMMENT='用户表';
```

---

### 2. 分类表 (category)

| 字段名 | 类型 | 约束 | 说明 |
|--------|------|------|------|
| id | BIGINT | PK, AUTO_INCREMENT | 分类ID |
| name | VARCHAR(50) | UNIQUE, NOT NULL | 分类名称 |
| color | VARCHAR(20) | DEFAULT '#1ABC9C' | 颜色 |

```sql
CREATE TABLE `category` (
  `id` BIGINT NOT NULL AUTO_INCREMENT COMMENT '分类ID',
  `name` VARCHAR(50) NOT NULL COMMENT '分类名称',
  `color` VARCHAR(20) DEFAULT '#1ABC9C' COMMENT '颜色',
  PRIMARY KEY (`id`),
  UNIQUE KEY `uk_name` (`name`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COMMENT='分类表';
```

---

### 3. 文章表 (article)

| 字段名 | 类型 | 约束 | 说明 |
|--------|------|------|------|
| id | BIGINT | PK, AUTO_INCREMENT | 文章ID |
| user_id | BIGINT | NOT NULL | 作者ID |
| category_id | BIGINT | | 分类ID |
| title | VARCHAR(200) | NOT NULL | 标题 |
| summary | VARCHAR(500) | | 摘要 |
| content | LONGTEXT | NOT NULL | 内容 |
| cover | VARCHAR(255) | | 封面图 |
| tags | VARCHAR(255) | | 标签(逗号分隔) |
| view_count | INT | DEFAULT 0 | 浏览量 |
| is_pinned | TINYINT | DEFAULT 0 | 是否置顶 |
| is_published | TINYINT | DEFAULT 1 | 是否发布 |
| created_at | DATETIME | DEFAULT CURRENT_TIMESTAMP | 创建时间 |
| updated_at | DATETIME | ON UPDATE CURRENT_TIMESTAMP | 更新时间 |

```sql
CREATE TABLE `article` (
  `id` BIGINT NOT NULL AUTO_INCREMENT COMMENT '文章ID',
  `user_id` BIGINT NOT NULL COMMENT '作者ID',
  `category_id` BIGINT COMMENT '分类ID',
  `title` VARCHAR(200) NOT NULL COMMENT '标题',
  `summary` VARCHAR(500) COMMENT '摘要',
  `content` LONGTEXT NOT NULL COMMENT '内容',
  `cover` VARCHAR(255) COMMENT '封面图',
  `tags` VARCHAR(255) COMMENT '标签(逗号分隔)',
  `view_count` INT DEFAULT 0 COMMENT '浏览量',
  `is_pinned` TINYINT DEFAULT 0 COMMENT '是否置顶',
  `is_published` TINYINT DEFAULT 1 COMMENT '是否发布',
  `created_at` DATETIME DEFAULT CURRENT_TIMESTAMP,
  `updated_at` DATETIME DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,
  PRIMARY KEY (`id`),
  KEY `idx_user_id` (`user_id`),
  KEY `idx_category_id` (`category_id`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COMMENT='文章表';
```

---

### 4. 收藏表 (favorite)

| 字段名 | 类型 | 约束 | 说明 |
|--------|------|------|------|
| id | BIGINT | PK, AUTO_INCREMENT | ID |
| user_id | BIGINT | NOT NULL | 用户ID |
| article_id | BIGINT | NOT NULL | 文章ID |
| created_at | DATETIME | DEFAULT CURRENT_TIMESTAMP | 收藏时间 |

```sql
CREATE TABLE `favorite` (
  `id` BIGINT NOT NULL AUTO_INCREMENT,
  `user_id` BIGINT NOT NULL COMMENT '用户ID',
  `article_id` BIGINT NOT NULL COMMENT '文章ID',
  `created_at` DATETIME DEFAULT CURRENT_TIMESTAMP,
  PRIMARY KEY (`id`),
  UNIQUE KEY `uk_user_article` (`user_id`, `article_id`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COMMENT='收藏表';
```

---

### 5. 浏览历史表 (view_history)

| 字段名 | 类型 | 约束 | 说明 |
|--------|------|------|------|
| id | BIGINT | PK, AUTO_INCREMENT | ID |
| user_id | BIGINT | NOT NULL | 用户ID |
| article_id | BIGINT | NOT NULL | 文章ID |
| viewed_at | DATETIME | DEFAULT CURRENT_TIMESTAMP | 浏览时间 |

```sql
CREATE TABLE `view_history` (
  `id` BIGINT NOT NULL AUTO_INCREMENT,
  `user_id` BIGINT NOT NULL COMMENT '用户ID',
  `article_id` BIGINT NOT NULL COMMENT '文章ID',
  `viewed_at` DATETIME DEFAULT CURRENT_TIMESTAMP COMMENT '浏览时间',
  PRIMARY KEY (`id`),
  KEY `idx_user_id` (`user_id`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COMMENT='浏览历史表';
```

---

## 初始化数据

```sql
-- 分类
INSERT INTO `category` (`name`, `color`) VALUES
('设计沉思', '#9B59B6'),
('技术探索', '#3498DB'),
('生活随笔', '#1ABC9C'),
('读书笔记', '#E67E22'),
('哲学思辨', '#E74C3C');

-- 管理员 (密码: 123456)
INSERT INTO `user` (`username`, `password`, `nickname`, `bio`) VALUES
('admin', '$2a$10$xxxxx', '林清远', '一个热爱思考与写作的设计师');
```

---

## ER 关系图

```
user (1) ──────< article (N)
  │                  │
  │                  │
  └──< favorite >────┘
  │                  │
  └──< view_history >┘

category (1) ──────< article (N)
```
